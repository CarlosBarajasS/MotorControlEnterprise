<div class="topbar">
  <div>
    <a routerLink="/cameras" class="back-link">â† Volver a CÃ¡maras</a>
    <h1>Grabaciones en la Nube</h1>
    <p class="subtitle">Respaldos almacenados en el servidor NAS central. Accesibles desde cualquier lugar.</p>
  </div>
  <div class="badge active" style="font-size: 13px; padding: 6px 12px;">Cam ID: <strong>{{ cameraId() }}</strong></div>
</div>

<div class="main-grid">
  <!-- Panel Izquierdo: Fechas y Archivos -->
  <div class="sidebar-panel">

    <div class="panel-card">
      <h3>ğŸ“… SelecciÃ³n de Fecha</h3>
      <div class="form-group">
        <label>Indica el dÃ­a a inspeccionar:</label>
        <input type="date" class="form-control" [ngModel]="selectedDate()" (ngModelChange)="selectDate($event)">
      </div>

      <div class="quick-dates" *ngIf="availableDates().length > 0">
        <small>Fechas con grabaciones disponibles:</small>
        <div class="pills">
          <span *ngFor="let d of availableDates()" class="date-pill" [class.active]="d === selectedDate()"
            (click)="selectDate(d)">
            {{ d }}
          </span>
        </div>
      </div>
    </div>

    <div class="panel-card mt-20">
      <h3>â˜ï¸ Grabaciones Cloud</h3>

      <!-- Loading -->
      <div *ngIf="loadingRecordings()" class="text-muted" style="text-align:center; padding:20px;">
        â³ Cargando grabaciones...
      </div>

      <!-- File list -->
      <div class="file-list" *ngIf="!loadingRecordings() && cloudRecordings().length > 0">
        <div class="file-item" *ngFor="let file of cloudRecordings()" (click)="playCloudVideo(file.path)">
          <span class="icon">â˜ï¸</span>
          <div class="details">
            <strong>{{ file.name }}</strong>
            <small>{{ file.sizeMb | number:'1.1-1' }} MB â€” {{ file.startTime | date:'HH:mm:ss' }}</small>
          </div>
        </div>
      </div>

      <!-- Empty state -->
      <div *ngIf="!loadingRecordings() && cloudRecordings().length === 0">
        <p class="text-muted">No hay grabaciones cloud para este dÃ­a.</p>
      </div>
    </div>

    <!-- Info card -->
    <div class="panel-card mt-20" style="background: #f0fdf4; border-color: #bbf7d0;">
      <h3 style="color: #15803d; border-bottom-color: #bbf7d0;">ğŸ’¡ Almacenamiento Local</h3>
      <p style="font-size: 13px; color: #166534; margin: 0;">
        Las grabaciones locales se almacenan directamente en el NVR/DVR del sitio.
        El cliente puede acceder a ellas desde el monitor conectado al equipo sin necesidad de internet.
      </p>
    </div>

  </div>

  <!-- Panel Derecho: Reproductor de Video -->
  <div class="viewer-panel">
    <div class="video-container" *ngIf="currentVideoSource(); else placeholder">
      <video #videoPlayer controls class="primary-player"></video>
      <div class="now-playing">
        Reproduciendo: <span class="mono">GrabaciÃ³n cloud</span>
      </div>
    </div>
    <ng-template #placeholder>
      <div class="empty-viewer">
        <span class="big-icon">ğŸï¸</span>
        <h3>Selecciona un archivo</h3>
        <p>Haz clic en una grabaciÃ³n del panel izquierdo para comenzar la reproducciÃ³n.</p>
      </div>
    </ng-template>
  </div>
</div>